
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>简单拖拽实现</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        #box {
            position: absolute;
            width: 400px;
            height: 400px;
            background: #ccc;
            border: 1px solid #333;
            left: 100px;
            right: 100px;
        }

        #dragBox {
            left: 50px;
            top: 50px;
            width: 50px;
            height: 50px;
            text-align: center;
            line-height: 50px;
            position: absolute;
            background: blue;
            cursor: move;
            font-size: 12px;
            color: #fff;
        }
    </style>
</head>
<body>
    <div id="box">

    </div>
    <div id="dragBox">拖我</div>

    <script type="text/javascript">
        (function () {
            var $ = function (id) {
                return typeof id == "string" ? document.getElementById(id) : id;
            }
            var Event = {
                bindEvent: function (node, type, func) { //事件绑定方法
                    if (node.addEventListener) {
                        node.addEventListener(type, func, false);
                    } else if (node.attachEvent) {
                        node.attachEvent("on" + type, func);
                    } else {
                        node["on" + type] = func;
                    }
                },
                getEvent: function (event) { //获取事件
                    return event ? event : window.event;
                },
                getTarget: function (event) { //获取事件目标
                    return event.target || event.srcElement;
                },
                getTargetP: function (event) {
                    return event.target.parentNode || event.srcElement.parentNode;
                }
            }
            var dragtarget = null;
            var dragf = function (ev) {
                var target = Event.getTarget(ev)
                var targetp = Event.getTargetP(ev);
             
                switch (event.type) {//判断事件类型
                    case "mousedown":
                        dragtarget = target
                        break;
                    case "mousemove":
                        if (dragtarget) {
                            $('dragBox').style.left = event.clientX + "px";
                            $('dragBox').style.top = event.clientY + "px";
                        }
                        //if (dragtarget && targetp) {
                        //    if (targetp.tagName == 'body') {
                        //        dragtarget.style.left = (event.clientX) + "px";
                        //        dragtarget.style.top = (event.clientY) + "px";
                        //    }
                        //    else {
                        //        dragtarget.style.left = (event.clientX - targetp.offsetLeft) + "px";
                        //        dragtarget.style.top = (event.clientY - targetp.offsetTop) + "px";
                        //    }
                        //    var left = parseInt(targetp.style.left);
                        //    var top = parseInt(targetp.style.top);
                        //    if (left < 0) {
                        //        dragtarget.style.left = 0 + "px";
                        //    }
                        //    if (top < 0) {
                        //        dragtarget.style.top = 0 + "px";
                        //    }
                        //    if (left > targetp.offsetWidth - dragtarget.offsetWidth) {
                        //        dragtarget.style.left = (targetp.offsetWidth - dragtarget.offsetWidth - 2) + "px";
                        //    }
                        //    if (top > targetp.offsetHeight - dragtarget.offsetHeight) {
                        //        dragtarget.style.top = (targetp.offsetHeight - dragtarget.offsetHeight - 2) + "px";
                        //    }

                        break;
                    case "mouseup":
                        dragtarget = null;
                        break;
                }
            }
            Event.bindEvent($('box'), 'mousedown', dragf)
            Event.bindEvent($('box'), 'mousemove', dragf)
            Event.bindEvent($('box'), 'mouseup', dragf)
            Event.bindEvent($('dragBox'), 'mousedown', dragf)
            Event.bindEvent($('dragBox'), 'mousemove', dragf)
            Event.bindEvent($('dragBox'), 'mouseup', dragf)
 

        })()

    </script>
    <script>
        var DragSpace;
        (function () {
            var DragDrop = function (e) {

            }

            var DragaddEventListener = function () {

            }
            var BindEvent = function (node, type, func, bool) {
                if (node.addEventListener) {
                    node.addEventListener(type, func, true)
                }
                else if (node.attachEvent) {
                    node.attachEvent("on" + type, func)
                }
                else {
                    node["on" + type] = func;
                }
            }
        })(DragSpace || (DragSpace = {}))

    </script>
    <script>
        var a = 'dfadsfddfsddf';
        a.replace(/\\d/, function () {

        })
    </script>
</body>
</html>
